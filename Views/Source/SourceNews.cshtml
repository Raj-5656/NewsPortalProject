@{
    ViewBag.Title = "SourceNews";
    Layout = "~/Views/Shared/_Source.cshtml";
}

<style>
    /* Navbar Styling */
    .navbar {
        background-color: #007bff; /* Bootstrap's primary color */
    }

    .navbar-brand {
        color: #fff !important; /* White color for the brand text */
        font-weight: bold;
    }

    .navbar-nav .nav-link {
        color: #fff !important; /* White color for the nav links */
        font-weight: 500;
        transition: color 0.3s;
    }

        .navbar-nav .nav-link:hover {
            color: #f8f9fa !important; /* Slightly lighter color on hover */
        }

    /* Card Styling */
    .card {
        border: none;
        transition: transform 0.2s;
        border-radius: 15px;
        height: 100%; /* Set fixed height for card */
    }

        .card:hover {
            transform: scale(1.02);
        }

    .card-img-top {
        border-top-left-radius: 15px;
        border-top-right-radius: 15px;
        object-fit: cover;
        height: 200px;
    }

    .card-body {
        background-color: #f9f9f9;
        border-bottom-left-radius: 15px;
        border-bottom-right-radius: 15px;
        height: calc(100% - 20px); /* Subtract padding from total height */
        overflow: auto; /* Enable scrolling if content exceeds card height */
    }

    .comment {
        background-color: #e9ecef;
        border-radius: 10px;
        padding: 10px;
        margin-top: 10px;
    }
</style>

<div class="container mt-4">
    <div class="row justify-content-center">
        @foreach (var item in Model)
        {
            var Title = item.GetType().GetProperty("Title").GetValue(item, null).ToString();
            var Text = item.GetType().GetProperty("Text").GetValue(item, null).ToString();
            var MultimediaUrl = item.GetType().GetProperty("MultimediaUrl").GetValue(item, null);
            var Comments = item.GetType().GetProperty("Comments").GetValue(item, null);

            // Truncate Title to 50 characters
            if (Title.Length > 50)
            {
                Title = Title.Substring(0, 50) + "...";
            }

            // Truncate Text to 150 words
            if (Text.Split(' ').Length > 50)
            {
                var words = Text.Split(' ');
                var truncatedWords = new string[50];
                Array.Copy(words, truncatedWords, 50);
                Text = string.Join(" ", truncatedWords) + "...";
            }

            <div class="col-md-5 col-lg-4 mb-4">
                <div class="card shadow">
                    <img src="~/Images/NewsImages/@MultimediaUrl" class="card-img-top" alt="MultimediaUrl">
                    <div class="card-body">
                        <h3 class="card-title">@Title</h3>
                        <p class="card-text">@Text</p>

                        <div class="comment mt-4">
                            <h5 class="mb-3"><b>Comments</b></h5>
                            @if (Comments != null)
                            {
                                foreach (var comment in (IEnumerable<object>)Comments)
                                {
                                    var Comment = comment.GetType().GetProperty("Comment").GetValue(comment, null);
                                    var CommentUserName = comment.GetType().GetProperty("UserName").GetValue(comment, null);
                                    <div>
                                        <p><b>@CommentUserName</b>: @Comment</p>
                                    </div>
                                }
                            }
                            else
                            {
                                <p>No comments yet.</p>
                            }
                        </div>
                    </div>
                </div>
            </div>
        }
    </div>
</div>

<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
